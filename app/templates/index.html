<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset='utf-8'>
	<title>LatexConverter</title>
	<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='dist/main.css') }}">
</head>
<body class="bg-gray-800">
	<div class="flex justify-center shadow-lg bg-gray-700 p-2">
		<h1 class="text-white text-3xl display-block text-center"> LatexConverter </h1>
	</div>
	{% with messages = get_flashed_messages('warning') %}
		{% if messages %}
			{% for message in messages %}
				<div class="bg-red-600 px-4 py-4 text-gray-100 text-center">
					<strong>{{ message[1] }}</strong>
					<button type="button" class="close" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
			{% endfor %}
		{% endif %}
	{% endwith %}

	{% if form.errors %}
		{% for field_name, field_errors in form.errors|dictsort if field_errors %}
			{% for error in field_errors %}
                <div class="bg-red-600 px-4 py-4 text-gray-100 text-center">
                    <strong>{{ form[field_name].label }}: {{ error }}</strong>
                    <button type="button" class="close" aria-label="Close">
                        <span aria-hidden="true" class="text-lg">&times;</span>
                    </button>
                </div>
            {% endfor %}
	    {% endfor %}
    {% endif %}

    <div class="bg-blue-400 px-4 py-4 text-gray-100 text-center hidden"
    id="copytoclip" role="alert">
        <strong>Copied to clipboard!</strong>
        <button type="button" class="close" aria-label="Close">
            <span aria-hidden="true" class="text-lg">&times;</span>
        </button>
    </div>
	<div class="bg-gray-800 flex flex-row justify-center mx-auto flex-wrap sm:flex-no-wrap w-full xl:w-8/12">
		<div class="bg-gray-100 p-4 rounded-lg m-2 sm:flex-grow flex-grow-0 min-w-lg shadow-lg">
			<form action="" method="post" class="flex flex-wrap flex-col">
				{{ form.csrf_token }}
				<div class="m-2 px-4 border-solid border-gray-700">
					<h2 class="text-gray-800 text-2xl">URL</h2>
					{% if form.url.raw_data %}
						<input class="border border-gray-500 rounded inline-block min-w-small border-sm" size="25" type="text" name="{{ form.url.name }}" value="{{ form.url.raw_data[0] }}" placeholder="CodiMD URL">
					{% else %}
						<input class="border border-gray-500 rounded inline-block min-w-small" type="text" name="{{ form.url.name }}" value="" placeholder="CodiMD URL">
					{% endif %}
				</div>
				<div class="m-2 px-4 border-solid border-gray-700">
					<h2 class="text-gray-800 text-2xl">Templates</h2>
					<ul class="text-gray-700">
					{% for template in form.template %}
						<li class="my-2">
                            <label class="checkmark-container flex items-center">
                                <input type="radio" class="hidden-input" id="{{ template.id }}" value="{{ template.object_data }}"
    								name="{{ template.name }}" {% if template.checked %} checked{% endif %}/>
                                <span class="checkmark"></span>
                                <span class="ml-2" >{{ template.label.text }}</span>
                            </label>
						</li>
					{% endfor %}
				</div>
				<div class="m-2 px-4 border-solid border-gray-700">
					<h2 class="text-gray-800 text-2xl">File</h2>
					<ul class="text-gray-700">
					{% for template in form.file_type %}
                        <li class="my-2">
                            <label class="checkmark-container flex items-center">
                                <input type="radio" class="hidden-input" id="{{ template.id }}" value="{{ template.object_data }}"
                                    name="{{ template.name }}" {% if template.checked %} checked{% endif %}/>
                                <span class="checkmark"></span>
                                <span class="ml-2" >{{ template.label.text }}</span>
                            </label>
                        </li>
					{% endfor %}
					</ul>
				</div>
				<button type="submit" class="shadow tracking-wider display-block bg-blue-200 m-4 px-3 py-1 rounded">
					Convert
				</button>
			</form>
		</div>
		{% if data %}
		<div class="w-10/12 bg-gray-200 m-2 p-4 sm:flex-grow flex-grow-0 rounded-lg">
			{% if form.file_type.data=="latex" %}
			<div class="">
				<textarea rows="15" class="h-auto bg-gray-100 w-full" type="text" id="result">{{ data }}</textarea>
			</div>
			<div class="flex flex-wrap flex-row">
				<div class="text-center">
					<button id="copytoclipbtn" class="m-2 shadow tracking-wider display-block bg-blue-200 px-3 py-1
						rounded">Copy Me</button>
				</div>
				<div class="text-center">
				<button id="download" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded inline-flex items-center">
					<svg class="fill-current w-4 h-4 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"/></svg>
				<span>Download</span>
				</button>
			</div>
			</div>
			{% endif %}
			{% if form.file_type.data=="pdf" %}
			<canvas id="pdf-canvas" data="{{ data }}"></canvas>
			<div class="inline-flex">
				<button class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-l" id="prev" aria-label="Previous">
					<span aria-hidden="true">&laquo;</span>
					<span class="sr-only">Previous</span>
				</button>
				<div class="bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 px-4">
					<span id="page_num"></span>/<span id="page_count"></span>
				</div>
				<button class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-r" id="next" aria-label="Previous">
					<span aria-hidden="true">&raquo;</span>
					<span class="sr-only">Previous</span>
				</button>
			</div>

			<button id="download-pdf" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded inline-flex items-center">
  				<svg class="fill-current w-4 h-4 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"/></svg>
  			<span>Download</span>
			</button>
			{% endif %}
		</div>
		{% endif %}
	</div>
	<script src="{{ url_for('static', filename='dist/main.bundle.js') }}"></script>
</body>
</html>
